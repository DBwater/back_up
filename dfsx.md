---
title: dfs序总结
date: 2016-08-26 17:20:41
tags: [acm,dfs]
---

关于树拉伸成线段树的一系列问题的总结

<!--more-->
dfs序就是用来维护一系列树上的问题的，这类问题主要解决一棵树上所有后代节点信息的更改和祖先节点有关，主要先通过dfs来记录一个树的顶点的出入戳，来控制他的所有儿子节点的状态的更新。用l[],r[]，来记录这个祖先节点控制的后代节点的区间。主要就一段函数。


```c
//l,r节点包含的子树左右边界，c线段树区间点表示的原节点序号，a原节点的价值
int l[maxn],r[maxn],c[maxn],a[maxn];
ll w[maxn];//顶点到某个节点的总价值
int tot;//dfs树节点的序号
vector<int>G[maxn];
int dfs(int x,int fa)
{
    l[x]=++tot;
    c[tot]=x;
    for(int i=0;i<G[x].size();i++){
        int v=G[x][i];
        if(v==fa)continue;
        w[v]+=w[x];
        dfs(v,x);
    }
    r[x]=tot;
}

```
# 相关的例题:

# [codeforces383C](http://codeforces.com/problemset/problem/383/C)
**题目意思：**
有一棵以1为根节点共n个节点的的树，每一个节点上都一个value值，执行m次操作。
现在有2种操作：
1.查询某一个节点的当前值
2.给某一个节点加上一个val值，而每一个节点加上val，其儿子节点就需要-val。
**题解：**
首先把所有节点分为奇数层和偶数层，可以发现偶数层的节点+val那么他的后代节点所有偶数层节点都要+val,奇数层都要-val，如果他是奇数层则相反
所有我们在用线段树维护一个区间的时候可以发现只有处于上层的线段能影响到下层，下面的线段不能影响都上层，所有我们可以更新的时候如果他是奇数层
就+（-val）,如果他是偶数层就是+val，然后查询的时候从线段树的最底层向上更新。如果查询数处于是奇数层向上更新的时候要所有val×-1,这样奇数层对奇数层
的影响就是增加，偶数层就是减少，反之亦然。(所有的奇数层是指他在原树上处于的层数)。
**代码：**

### [查看代码]()

